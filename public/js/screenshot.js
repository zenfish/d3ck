// Muaz Khan     - https://github.com/muaz-khan
// MIT License   - https://www.webrtc-experiment.com/licence/
// Documentation - https://github.com/muaz-khan/WebRTC-Experiment/tree/master/part-of-screen-sharing

// Note: All libraries listed in this file are "external libraries" 
// ----  and has their own copyrights. Taken from "html2canvas" project.

"use strict";function h2clog(n){_html2canvas.logging&&window.console&&window.console.log&&window.console.log(n)}function backgroundBoundsFactory(n,t,i,r,u,f){var e=_html2canvas.Util.getCSS(t,n,u),h,o,s,l,c;return e.length===1&&(l=e[0],e=[],e[0]=l,e[1]=l),e[0].toString().indexOf("%")!==-1?(s=parseFloat(e[0])/100,o=i.width*s,n!=="backgroundSize"&&(o-=(f||r).width*s)):n==="backgroundSize"?e[0]==="auto"?o=r.width:e[0].match(/contain|cover/)?(c=_html2canvas.Util.resizeBounds(r.width,r.height,i.width,i.height,e[0]),o=c.width,h=c.height):o=parseInt(e[0],10):o=parseInt(e[0],10),e[1]==="auto"?h=o/r.width*r.height:e[1].toString().indexOf("%")!==-1?(s=parseFloat(e[1])/100,h=i.height*s,n!=="backgroundSize"&&(h-=(f||r).height*s)):h=parseInt(e[1],10),[o,h]}function h2czContext(n){return{zindex:n,children:[]}}function h2cRenderContext(n,t){var i=[];return{storage:i,width:n,height:t,clip:function(){i.push({type:"function",name:"clip",arguments:arguments})},translate:function(){i.push({type:"function",name:"translate",arguments:arguments})},fill:function(){i.push({type:"function",name:"fill",arguments:arguments})},save:function(){i.push({type:"function",name:"save",arguments:arguments})},restore:function(){i.push({type:"function",name:"restore",arguments:arguments})},fillRect:function(){i.push({type:"function",name:"fillRect",arguments:arguments})},createPattern:function(){i.push({type:"function",name:"createPattern",arguments:arguments})},drawShape:function(){var n=[];return i.push({type:"function",name:"drawShape",arguments:n}),{moveTo:function(){n.push({name:"moveTo",arguments:arguments})},lineTo:function(){n.push({name:"lineTo",arguments:arguments})},arcTo:function(){n.push({name:"arcTo",arguments:arguments})},bezierCurveTo:function(){n.push({name:"bezierCurveTo",arguments:arguments})},quadraticCurveTo:function(){n.push({name:"quadraticCurveTo",arguments:arguments})}}},drawImage:function(){i.push({type:"function",name:"drawImage",arguments:arguments})},fillText:function(){i.push({type:"function",name:"fillText",arguments:arguments})},setVariable:function(n,t){i.push({type:"variable",name:n,arguments:t})}}}var _html2canvas={},previousElement,computedCSS,html2canvas;_html2canvas.Util={},_html2canvas.Util.trimText=function(n){return function(t){return n?n.apply(t):((t||"")+"").replace(/^\s+|\s+$/g,"")}}(String.prototype.trim),_html2canvas.Util.parseBackgroundImage=function(n){var p=" \r\n\t",i,r,a,l,e,y=[],t,u=0,o=0,f,s,h=function(){i&&(r.substr(0,1)==='"'&&(r=r.substr(1,r.length-2)),r&&s.push(r),i.substr(0,1)==="-"&&(l=i.indexOf("-",1)+1)>0&&(a=i.substr(0,l),i=i.substr(l)),y.push({prefix:a,method:i.toLowerCase(),value:e,args:s})),s=[],i=a=r=e=""},c,v;for(h(),c=0,v=n.length;c<v;c++){t=n[c];if(u===0&&p.indexOf(t)>-1)continue;switch(t){case'"':f?f===t&&(f=null):f=t;break;case"(":if(f)break;else if(u===0){u=1,e+=t;continue}else o++;break;case")":if(f)break;else if(u===1)if(o===0){u=0,e+=t,h();continue}else o--;break;case",":if(f)break;else if(u===0){h();continue}else if(u===1)if(o===0&&!i.match(/^url$/i)){s.push(r),r="",e+=t;continue}}e+=t,u===0?i+=t:r+=t}return h(),y},_html2canvas.Util.Bounds=function(n){var t,i={};if(n.getBoundingClientRect)return t=n.getBoundingClientRect(),i.top=t.top,i.bottom=t.bottom||t.top+t.height,i.left=t.left,i.width=t.width||t.right-t.left,i.height=t.height||t.bottom-t.top,i},_html2canvas.Util.getCSS=function(n,t,i){function f(t,i){var u=n.runtimeStyle&&n.runtimeStyle[t],f,r=n.style;return!/^-?[0-9]+\.?[0-9]*(?:px)?$/i.test(i)&&/^-?\d/.test(i)&&(f=r.left,u&&(n.runtimeStyle.left=n.currentStyle.left),r.left=t==="fontSize"?"1em":i||0,i=r.pixelLeft+"px",r.left=f,u&&(n.runtimeStyle.left=u)),/^(thin|medium|thick)$/i.test(i)?i:Math.round(parseFloat(i))+"px"}var r,e=t.match(/^background(Size|Position)$/),u;previousElement!==n&&(computedCSS=document.defaultView.getComputedStyle(n,null)),r=computedCSS[t];if(e){r=(r||"").split(","),r=r[i||0]||r[0]||"auto",r=_html2canvas.Util.trimText(r).split(" ");if(t!=="backgroundSize"||r[0]&&!r[0].match(/cover|contain|auto/)){r[0]=r[0].indexOf("%")===-1?f(t+"X",r[0]):r[0];if(r[1]===undefined){if(t==="backgroundSize")return r[1]="auto",r;r[1]=r[0]}r[1]=r[1].indexOf("%")===-1?f(t+"Y",r[1]):r[1]}}else/border(Top|Bottom)(Left|Right)Radius/.test(t)&&(u=r.split(" "),u.length>1||(u[1]=u[0]),u[0]=parseInt(u[0],10),u[1]=parseInt(u[1],10),r=u);return r},_html2canvas.Util.resizeBounds=function(n,t,i,r,u){var s=i/r,o=n/t,f,e;return u&&u!=="auto"?s<o^u==="contain"?(e=r,f=r*o):(f=i,e=i/o):(f=i,e=r),{width:f,height:e}},_html2canvas.Util.BackgroundPosition=function(n,t,i,r,u){var f=backgroundBoundsFactory("backgroundPosition",n,t,i,r,u);return{left:f[0],top:f[1]}},_html2canvas.Util.BackgroundSize=function(n,t,i,r){var u=backgroundBoundsFactory("backgroundSize",n,t,i,r);return{width:u[0],height:u[1]}},_html2canvas.Util.Extend=function(n,t){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i]);return t},_html2canvas.Util.Children=function(n){var t;try{t=n.nodeName&&n.nodeName.toUpperCase()==="IFRAME"?n.contentDocument||n.contentWindow.document:function(n){var t=[];return n!==null&&(function(n,t){var r=n.length,i=0,u;if(typeof t.length=="number")for(u=t.length;i<u;i++)n[r++]=t[i];else while(t[i]!==undefined)n[r++]=t[i++];return n.length=r,n})(t,n),t}(n.childNodes)}catch(i){h2clog("html2canvas.Util.Children failed with exception: "+i.message),t=[]}return t},_html2canvas.Util.Font=function(){var n={};return function(t,i,r){if(n[t+"-"+i]!==undefined)return n[t+"-"+i];var u=r.createElement("div"),f=r.createElement("img"),e=r.createElement("span"),c="Hidden Text",s,h,o;return u.style.visibility="hidden",u.style.fontFamily=t,u.style.fontSize=i,u.style.margin=0,u.style.padding=0,r.body.appendChild(u),f.src="data:image/gif;base64,R0lGODlhAQABAIABAP///wAAACwAAAAAAQABAAACAkQBADs=",f.width=1,f.height=1,f.style.margin=0,f.style.padding=0,f.style.verticalAlign="baseline",e.style.fontFamily=t,e.style.fontSize=i,e.style.margin=0,e.style.padding=0,e.appendChild(r.createTextNode(c)),u.appendChild(e),u.appendChild(f),s=f.offsetTop-e.offsetTop+1,u.removeChild(e),u.appendChild(r.createTextNode(c)),u.style.lineHeight="normal",f.style.verticalAlign="super",h=f.offsetTop-u.offsetTop+1,o={baseline:s,lineWidth:1,middle:h},n[t+"-"+i]=o,r.body.removeChild(u),o}}(),(function(){_html2canvas.Generate={};var n=[/^(-webkit-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-gradient)\((linear|radial),\s((?:\d{1,3}%?)\s(?:\d{1,3}%?),\s(?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)\-]+)\)$/,/^(-moz-linear-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-moz-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s?([a-z\-]*)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/];_html2canvas.Generate.parseGradient=function(t,i){for(var r,p=n.length,s,o,u,h,c,e,y,l,a,v,f=0;f<p;f+=1){s=t.match(n[f]);if(s)break}if(s)switch(s[1]){case"-webkit-linear-gradient":case"-o-linear-gradient":r={type:"linear",x0:null,y0:null,x1:null,y1:null,colorStops:[]},u=s[2].match(/\w+/g);if(u)for(h=u.length,f=0;f<h;f+=1)switch(u[f]){case"top":r.y0=0,r.y1=i.height;break;case"right":r.x0=i.width,r.x1=0;break;case"bottom":r.y0=i.height,r.y1=0;break;case"left":r.x0=0,r.x1=i.width}r.x0===null&&r.x1===null&&(r.x0=r.x1=i.width/2),r.y0===null&&r.y1===null&&(r.y0=r.y1=i.height/2),u=s[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g);if(u)for(h=u.length,c=1/Math.max(h-1,1),f=0;f<h;f+=1)e=u[f].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/),e[2]?(o=parseFloat(e[2]),o/=e[3]==="%"?100:i.width):o=f*c,r.colorStops.push({color:e[1],stop:o});break;case"-webkit-gradient":r={type:s[2]==="radial"?"circle":s[2],x0:0,y0:0,x1:0,y1:0,colorStops:[]},u=s[3].match(/(\d{1,3})%?\s(\d{1,3})%?,\s(\d{1,3})%?\s(\d{1,3})%?/),u&&(r.x0=u[1]*i.width/100,r.y0=u[2]*i.height/100,r.x1=u[3]*i.width/100,r.y1=u[4]*i.height/100),u=s[4].match(/((?:from|to|color-stop)\((?:[0-9\.]+,\s)?(?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)\))+/g);if(u)for(h=u.length,f=0;f<h;f+=1)e=u[f].match(/(from|to|color-stop)\(([0-9\.]+)?(?:,\s)?((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\)/),o=parseFloat(e[2]),e[1]==="from"&&(o=0),e[1]==="to"&&(o=1),r.colorStops.push({color:e[3],stop:o});break;case"-moz-linear-gradient":r={type:"linear",x0:0,y0:0,x1:0,y1:0,colorStops:[]},u=s[2].match(/(\d{1,3})%?\s(\d{1,3})%?/),u&&(r.x0=u[1]*i.width/100,r.y0=u[2]*i.height/100,r.x1=i.width-r.x0,r.y1=i.height-r.y0),u=s[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}%)?)+/g);if(u)for(h=u.length,c=1/Math.max(h-1,1),f=0;f<h;f+=1)e=u[f].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%)?/),e[2]?(o=parseFloat(e[2]),e[3]&&(o/=100)):o=f*c,r.colorStops.push({color:e[1],stop:o});break;case"-webkit-radial-gradient":case"-moz-radial-gradient":case"-o-radial-gradient":r={type:"circle",x0:0,y0:0,x1:i.width,y1:i.height,cx:0,cy:0,rx:0,ry:0,colorStops:[]},u=s[2].match(/(\d{1,3})%?\s(\d{1,3})%?/),u&&(r.cx=u[1]*i.width/100,r.cy=u[2]*i.height/100),u=s[3].match(/\w+/),e=s[4].match(/[a-z\-]*/);if(u&&e)switch(e[0]){case"farthest-corner":case"cover":case"":y=Math.sqrt(Math.pow(r.cx,2)+Math.pow(r.cy,2)),l=Math.sqrt(Math.pow(r.cx,2)+Math.pow(r.y1-r.cy,2)),a=Math.sqrt(Math.pow(r.x1-r.cx,2)+Math.pow(r.y1-r.cy,2)),v=Math.sqrt(Math.pow(r.x1-r.cx,2)+Math.pow(r.cy,2)),r.rx=r.ry=Math.max(y,l,a,v);break;case"closest-corner":y=Math.sqrt(Math.pow(r.cx,2)+Math.pow(r.cy,2)),l=Math.sqrt(Math.pow(r.cx,2)+Math.pow(r.y1-r.cy,2)),a=Math.sqrt(Math.pow(r.x1-r.cx,2)+Math.pow(r.y1-r.cy,2)),v=Math.sqrt(Math.pow(r.x1-r.cx,2)+Math.pow(r.cy,2)),r.rx=r.ry=Math.min(y,l,a,v);break;case"farthest-side":u[0]==="circle"?r.rx=r.ry=Math.max(r.cx,r.cy,r.x1-r.cx,r.y1-r.cy):(r.type=u[0],r.rx=Math.max(r.cx,r.x1-r.cx),r.ry=Math.max(r.cy,r.y1-r.cy));break;case"closest-side":case"contain":u[0]==="circle"?r.rx=r.ry=Math.min(r.cx,r.cy,r.x1-r.cx,r.y1-r.cy):(r.type=u[0],r.rx=Math.min(r.cx,r.x1-r.cx),r.ry=Math.min(r.cy,r.y1-r.cy))}u=s[5].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g);if(u)for(h=u.length,c=1/Math.max(h-1,1),f=0;f<h;f+=1)e=u[f].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/),e[2]?(o=parseFloat(e[2]),o/=e[3]==="%"?100:i.width):o=f*c,r.colorStops.push({color:e[1],stop:o})}return r},_html2canvas.Generate.Gradient=function(n,t){var e,u,i,f,r,o;if(t.width===0||t.height===0)return;e=document.createElement("canvas"),u=e.getContext("2d"),e.width=t.width,e.height=t.height,i=_html2canvas.Generate.parseGradient(n,t);if(i)if(i.type==="linear"){for(f=u.createLinearGradient(i.x0,i.y0,i.x1,i.y1),r=0,o=i.colorStops.length;r<o;r+=1)try{f.addColorStop(i.colorStops[r].stop,i.colorStops[r].color)}catch(a){h2clog(["failed to add color stop: ",a,"; tried to add: ",i.colorStops[r],"; stop: ",r,"; in: ",n])}u.fillStyle=f,u.fillRect(0,0,t.width,t.height)}else if(i.type==="circle"){for(f=u.createRadialGradient(i.cx,i.cy,0,i.cx,i.cy,i.rx),r=0,o=i.colorStops.length;r<o;r+=1)try{f.addColorStop(i.colorStops[r].stop,i.colorStops[r].color)}catch(a){h2clog(["failed to add color stop: ",a,"; tried to add: ",i.colorStops[r],"; stop: ",r,"; in: ",n])}u.fillStyle=f,u.fillRect(0,0,t.width,t.height)}else if(i.type==="ellipse"){var s=document.createElement("canvas"),c=s.getContext("2d"),l=Math.max(i.rx,i.ry),h=l*2,v;for(s.width=s.height=h,f=c.createRadialGradient(i.rx,i.ry,0,i.rx,i.ry,l),r=0,o=i.colorStops.length;r<o;r+=1)try{f.addColorStop(i.colorStops[r].stop,i.colorStops[r].color)}catch(a){h2clog(["failed to add color stop: ",a,"; tried to add: ",i.colorStops[r],"; stop: ",r,"; in: ",n])}c.fillStyle=f,c.fillRect(0,0,h,h),u.fillStyle=i.colorStops[r-1].color,u.fillRect(0,0,e.width,e.height),u.drawImage(s,i.cx-i.rx,i.cy-i.ry,2*i.rx,2*i.ry)}return e},_html2canvas.Generate.ListAlpha=function(n){var t="",i;do i=n%26,t=String.fromCharCode(i+64)+t,n=n/26;while(n*26>26);return t},_html2canvas.Generate.ListRoman=function(n){var r=["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"],u=[1e3,900,500,400,100,90,50,40,10,9,5,4,1],i="",t,f=r.length;if(n<=0||n>=4e3)return n;for(t=0;t<f;t+=1)while(n>=u[t])n-=u[t],i+=r[t];return i}})(),_html2canvas.Parse=function(n,t){function rt(){return Math.max(Math.max(r.body.scrollWidth,r.documentElement.scrollWidth),Math.max(r.body.offsetWidth,r.documentElement.offsetWidth),Math.max(r.body.clientWidth,r.documentElement.clientWidth))}function ot(){return Math.max(Math.max(r.body.scrollHeight,r.documentElement.scrollHeight),Math.max(r.body.offsetHeight,r.documentElement.offsetHeight),Math.max(r.body.clientHeight,r.documentElement.clientHeight))}function s(n,t){var r=parseInt(i(n,t),10);return isNaN(r)?0:r}function c(n,t,i,r,u,f){f!=="transparent"&&(n.setVariable("fillStyle",f),n.fillRect(t,i,r,u),l+=1)}function si(n,t){switch(t){case"lowercase":return n.toLowerCase();case"capitalize":return n.replace(/(^|\s|:|-|\(|\))([a-z])/g,function(n,t,i){if(n.length>0)return t+i.toUpperCase()});case"uppercase":return n.toUpperCase();default:return n}}function oi(n){return/^(normal|none|0px)$/.test(n)}function et(n,t,i,r){n!==null&&_html2canvas.Util.trimText(n).length>0&&(r.fillText(n,t,i),l+=1)}function ht(n,t,u,f){var h=!1,e=i(t,"fontWeight"),o=i(t,"fontFamily"),s=i(t,"fontSize");switch(parseInt(e,10)){case 401:e="bold";break;case 400:e="normal"}return n.setVariable("fillStyle",f),n.setVariable("font",[i(t,"fontStyle"),i(t,"fontVariant"),e,s,o].join(" ")),n.setVariable("textAlign",h?"right":"left"),u!=="none"?_html2canvas.Util.Font(o,s,r):void 0}function ci(n,t,i,r,u){switch(t){case"underline":c(n,i.left,Math.round(i.top+r.baseline+r.lineWidth),i.width,1,u);break;case"overline":c(n,i.left,Math.round(i.top),i.width,1,u);break;case"line-through":c(n,i.left,Math.ceil(i.top+r.middle+r.lineWidth),i.width,1,u)}}function hi(n,t,i,r){var u,f;return st.rangeBounds?((i!=="none"||_html2canvas.Util.trimText(t).length!==0)&&(u=ui(t,n.node,n.textOffset)),n.textOffset+=t.length):n.node&&typeof n.node.nodeValue=="string"&&(f=r?n.node.splitText(t.length):null,u=ri(n.node),n.node=f),u}function ui(n,t,i){var u=r.createRange();return u.setStart(t,i),u.setEnd(t,i+n.length),u.getBoundingClientRect()}function ri(n){var u=n.parentNode,t=r.createElement("wrapper"),f=n.cloneNode(!0),i;return t.appendChild(n.cloneNode(!0)),u.replaceChild(t,n),i=_html2canvas.Util.Bounds(t),u.replaceChild(f,t),i}function ct(n,r,u){var s=u.ctx,c=i(n,"color"),o=i(n,"textDecoration"),e=i(n,"textAlign"),h,f,l={node:r,textOffset:0};_html2canvas.Util.trimText(r.nodeValue).length>0&&(r.nodeValue=si(r.nodeValue,i(n,"textTransform")),e=e.replace(["-webkit-auto"],["auto"]),f=!t.letterRendering&&/^(left|right|justify|auto)$/.test(e)&&oi(i(n,"letterSpacing"))?r.nodeValue.split(/(\b| )/):r.nodeValue.split(""),h=ht(s,n,o,c),t.chinese&&f.forEach(function(n,t){/.*[\u4E00-\u9FA5].*$/.test(n)&&(n=n.split(""),n.unshift(t,1),f.splice.apply(f,n))}),f.forEach(function(n,t){var i=hi(l,n,o,t<f.length-1);i&&(et(n,i.left,i.bottom,s),ci(s,o,i,h,c))}))}function ei(n,t){var i=r.createElement("boundelement"),f,u;return i.style.display="inline",f=n.style.listStyleType,n.style.listStyleType="none",i.appendChild(r.createTextNode(t)),n.insertBefore(i,n.firstChild),u=_html2canvas.Util.Bounds(i),n.removeChild(i),n.style.listStyleType=f,u}function fi(n){var r=-1,i=1,t=n.parentNode.childNodes;if(n.parentNode){while(t[++r]!==n)t[r].nodeType===1&&i++;return i}return-1}function li(n,t){var i=fi(n),r;switch(t){case"decimal":r=i;break;case"decimal-leading-zero":r=i.toString().length===1?i="0"+i.toString():i.toString();break;case"upper-roman":r=_html2canvas.Generate.ListRoman(i);break;case"lower-roman":r=_html2canvas.Generate.ListRoman(i).toLowerCase();break;case"lower-alpha":r=_html2canvas.Generate.ListAlpha(i).toLowerCase();break;case"upper-alpha":r=_html2canvas.Generate.ListAlpha(i)}return r+=". "}function bi(n,t,r){var s,f,u=t.ctx,o=i(n,"listStyleType"),e;if(/^(decimal|decimal-leading-zero|upper-alpha|upper-latin|upper-roman|lower-alpha|lower-greek|lower-latin|lower-roman)$/i.test(o)){f=li(n,o),e=ei(n,f),ht(u,n,"none",i(n,"color"));if(i(n,"listStylePosition")==="inside")u.setVariable("textAlign","left"),s=r.left;else return;et(f,s,e.bottom,u)}}function d(t){var i=n[t];return i&&i.succeeded===!0?i.img:!1}function g(n,t){var r=Math.max(n.left,t.left),i=Math.max(n.top,t.top),f=Math.min(n.left+n.width,t.left+t.width),u=Math.min(n.top+n.height,t.top+t.height);return{left:r,top:i,width:f-r,height:u-i}}function wi(n,t){var i;return t?n!=="auto"?(i=h2czContext(n),t.children.push(i),i):t:i=h2czContext(0)}function nt(n,t,i,r,u){var e=s(t,"paddingLeft"),f=s(t,"paddingTop"),h=s(t,"paddingRight"),o=s(t,"paddingBottom");ut(n,i,0,0,i.width,i.height,r.left+e+u[3].width,r.top+f+u[0].width,r.width-(u[1].width+u[3].width+e+h),r.height-(u[0].width+u[2].width+f+o))}function di(n){return["Top","Right","Bottom","Left"].map(function(t){return{width:s(n,"border"+t+"Width"),color:i(n,"border"+t+"Color")}})}function ki(n){return["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(t){return i(n,"border"+t+"Radius")})}function o(n,t,i,r){var u=function(n,t,i){return{x:n.x+(t.x-n.x)*i,y:n.y+(t.y-n.y)*i}};return{start:n,startControl:t,endControl:i,end:r,subdivide:function(f){var c=u(n,t,f),l=u(t,i,f),a=u(i,r,f),e=u(c,l,f),s=u(l,a,f),h=u(e,s,f);return[o(n,c,e,h),o(h,s,a,r)]},curveTo:function(n){n.push(["bezierCurve",t.x,t.y,i.x,i.y,r.x,r.y])},curveToReversed:function(r){r.push(["bezierCurve",i.x,i.y,t.x,t.y,n.x,n.y])}}}function e(n,t,i,r,u,f,e){t[0]>0||t[1]>0?(n.push(["line",r[0].start.x,r[0].start.y]),r[0].curveTo(n),r[1].curveTo(n)):n.push(["line",f,e]),(i[0]>0||i[1]>0)&&n.push(["line",u[0].start.x,u[0].start.y])}function h(n,t,i,r,u,f,e){var o=[];return t[0]>0||t[1]>0?(o.push(["line",r[1].start.x,r[1].start.y]),r[1].curveTo(o)):o.push(["line",n.c1[0],n.c1[1]]),i[0]>0||i[1]>0?(o.push(["line",f[0].start.x,f[0].start.y]),f[0].curveTo(o),o.push(["line",e[0].end.x,e[0].end.y]),e[0].curveToReversed(o)):(o.push(["line",n.c2[0],n.c2[1]]),o.push(["line",n.c3[0],n.c3[1]])),t[0]>0||t[1]>0?(o.push(["line",u[1].end.x,u[1].end.y]),u[1].curveToReversed(o)):o.push(["line",n.c4[0],n.c4[1]]),o}function vi(n,t,i){var f=n.left,r=n.top,e=n.width,a=n.height,k=t[0][0],w=t[0][1],l=t[1][0],b=t[1][1],s=t[2][0],o=t[2][1],d=t[3][0],c=t[3][1],h=e-l,y=a-s,p=e-o,v=a-c;return{topLeftOuter:u(f,r,k,w).topLeft.subdivide(.5),topLeftInner:u(f+i[3].width,r+i[0].width,Math.max(0,k-i[3].width),Math.max(0,w-i[0].width)).topLeft.subdivide(.5),topRightOuter:u(f+h,r,l,b).topRight.subdivide(.5),topRightInner:u(f+Math.min(h,e+i[3].width),r+i[0].width,h>e+i[3].width?0:l-i[3].width,b-i[0].width).topRight.subdivide(.5),bottomRightOuter:u(f+p,r+y,o,s).bottomRight.subdivide(.5),bottomRightInner:u(f+Math.min(p,e+i[3].width),r+Math.min(y,a+i[0].width),Math.max(0,o-i[1].width),Math.max(0,s-i[2].width)).bottomRight.subdivide(.5),bottomLeftOuter:u(f,r+v,d,c).bottomLeft.subdivide(.5),bottomLeftInner:u(f+i[3].width,r+v,Math.max(0,d-i[3].width),Math.max(0,c-i[2].width)).bottomLeft.subdivide(.5)}}function ai(n,t,r,u,f){var s=i(n,"backgroundClip"),o=[];switch(s){case"content-box":case"padding-box":e(o,u[0],u[1],t.topLeftInner,t.topRightInner,f.left+r[3].width,f.top+r[0].width),e(o,u[1],u[2],t.topRightInner,t.bottomRightInner,f.left+f.width-r[1].width,f.top+r[0].width),e(o,u[2],u[3],t.bottomRightInner,t.bottomLeftInner,f.left+f.width-r[1].width,f.top+f.height-r[2].width),e(o,u[3],u[0],t.bottomLeftInner,t.topLeftInner,f.left+r[3].width,f.top+f.height-r[2].width);break;default:e(o,u[0],u[1],t.topLeftOuter,t.topRightOuter,f.left,f.top),e(o,u[1],u[2],t.topRightOuter,t.bottomRightOuter,f.left+f.width,f.top),e(o,u[2],u[3],t.bottomRightOuter,t.bottomLeftOuter,f.left+f.width,f.top+f.height),e(o,u[3],u[0],t.bottomLeftOuter,t.topLeftOuter,f.left,f.top+f.height)}return o}function pi(n,t,i){for(var v=t.left,w=t.top,y=t.width,p=t.height,u,r,e,o,l,s=ki(n),f=vi(t,s,i),a={clip:ai(n,f,i,s,t),borders:[]},c=0;c<4;c++)if(i[c].width>0){u=v,r=w,e=y,o=p-i[2].width;switch(c){case 0:o=i[0].width,l=h({c1:[u,r],c2:[u+e,r],c3:[u+e-i[1].width,r+o],c4:[u+i[3].width,r+o]},s[0],s[1],f.topLeftOuter,f.topLeftInner,f.topRightOuter,f.topRightInner);break;case 1:u=v+y-i[1].width,e=i[1].width,l=h({c1:[u+e,r],c2:[u+e,r+o+i[2].width],c3:[u,r+o],c4:[u,r+i[0].width]},s[1],s[2],f.topRightOuter,f.topRightInner,f.bottomRightOuter,f.bottomRightInner);break;case 2:r=r+p-i[2].width,o=i[2].width,l=h({c1:[u+e,r+o],c2:[u,r+o],c3:[u+i[3].width,r],c4:[u+e-i[2].width,r]},s[2],s[3],f.bottomRightOuter,f.bottomRightInner,f.bottomLeftOuter,f.bottomLeftInner);break;case 3:e=i[3].width,l=h({c1:[u,r+o+i[2].width],c2:[u,r],c3:[u+e,r+i[0].width],c4:[u+e,r+o]},s[3],s[0],f.bottomLeftOuter,f.bottomLeftInner,f.topLeftOuter,f.topLeftInner)}a.borders.push({args:l,color:i[c].color})}return a}function k(n,t){var i=n.drawShape();return t.forEach(function(n,t){i[t===0?"moveTo":n[0]+"To"].apply(null,n.slice(1))}),i}function yi(n,t,i){i!=="transparent"&&(n.setVariable("fillStyle",i),k(n,t),n.fill(),l+=1)}function b(n,t,u){var f=r.createElement("valuewrap"),s=["lineHeight","textAlign","fontFamily","color","fontSize","paddingLeft","paddingTop","width","height","border","borderLeftWidth","borderTopWidth"],e,o;s.forEach(function(t){try{f.style[t]=i(n,t)}catch(r){h2clog("html2canvas: Parse: Exception caught in renderFormValue: "+r.message)}}),f.style.borderColor="black",f.style.borderStyle="solid",f.style.display="block",f.style.position="absolute",(/^(submit|reset|button|text|password)$/.test(n.type)||n.nodeName==="SELECT")&&(f.style.lineHeight=i(n,"height")),f.style.top=t.top+"px",f.style.left=t.left+"px",e=n.nodeName==="SELECT"?(n.options[n.selectedIndex]||0).text:n.value,e||(e=n.placeholder),o=r.createTextNode(e),f.appendChild(o),v.appendChild(f),ct(n,o,u),v.removeChild(f)}function ut(n){n.drawImage.apply(n,Array.prototype.slice.call(arguments,1)),l+=1}function tt(n,t){var r=window.getComputedStyle(n,t),i,e,o,u;if(r&&r.content&&r.content!=="none"&&r.content!=="-moz-alt-content")return i=r.content+"",e=i.substr(0,1),e===i.substr(i.length-1)&&e.match(/'|"/)&&(i=i.substr(1,i.length-2)),o=i.substr(0,3)==="url",u=document.createElement(o?"img":"span"),u.className=f+"-before "+f+"-after",Object.keys(r).filter(yt).forEach(function(n){u.style[n]=r[n]}),o?u.src=_html2canvas.Util.parseBackgroundImage(i)[0].args[0]:u.innerHTML=i,u}function yt(n){return isNaN(window.parseInt(n,10))}function pt(n,t){var r=tt(n,":before"),i=tt(n,":after");if(!r&&!i)return;r&&(n.className+=" "+f+"-before",n.parentNode.insertBefore(r,n),a(r,t,!0),n.parentNode.removeChild(r),n.className=n.className.replace(f+"-before","").trim()),i&&(n.className+=" "+f+"-after",n.appendChild(i),a(i,t,!0),n.removeChild(i),n.className=n.className.replace(f+"-after","").trim())}function it(n,t,i,r){var f=Math.round(r.left+i.left),u=Math.round(r.top+i.top);n.createPattern(t),n.translate(f,u),n.fill(),n.translate(-f,-u)}function y(n,t,i,r,u,f,e,o){var s=[];s.push(["line",Math.round(u),Math.round(f)]),s.push(["line",Math.round(u+e),Math.round(f)]),s.push(["line",Math.round(u+e),Math.round(o+f)]),s.push(["line",Math.round(u),Math.round(o+f)]),k(n,s),n.save(),n.clip(),it(n,t,i,r),n.restore()}function ti(n,t,i){c(n,t.left,t.top,t.width,t.height,i)}function bt(n,t,r,u,f){var s=_html2canvas.Util.BackgroundSize(n,t,u,f),e=_html2canvas.Util.BackgroundPosition(n,t,u,f,s),o=i(n,"backgroundRepeat").split(",").map(function(n){return n.trim()});u=dt(u,s),o=o[f]||o[0];switch(o){case"repeat-x":y(r,u,e,t,t.left,t.top+e.top,99999,u.height);break;case"repeat-y":y(r,u,e,t,t.left+e.left,t.top,u.width,99999);break;case"no-repeat":y(r,u,e,t,t.left+e.left,t.top+e.top,u.width,u.height);break;default:it(r,u,e,{top:t.top,left:t.left,width:u.width,height:u.height})}}function wt(n,t,r){var u=i(n,"backgroundImage"),s=_html2canvas.Util.parseBackgroundImage(u),e,f=s.length,o;while(f--){u=s[f];if(!u.args||u.args.length===0)continue;o=u.method==="url"?u.args[0]:u.value,e=d(o),e?bt(n,t,r,e,f):h2clog("html2canvas: Error loading background:",u)}}function dt(n,t){if(n.width===t.width&&n.height===t.height)return n;var u,i=r.createElement("canvas");return i.width=t.width,i.height=t.height,u=i.getContext("2d"),ut(u,n,0,0,n.width,n.height,0,0,t.width,t.height),i}function kt(n,t,r){var u=i(t,"opacity")*(r?r.opacity:1);return n.setVariable("globalAlpha",u),u}function gt(n,r,u){var e=h2cRenderContext(r?u.width:rt(),r?u.height:ot()),f={ctx:e,zIndex:wi(i(n,"zIndex"),r?r.zIndex:null),opacity:kt(e,n,r),cssPosition:i(n,"position"),borders:di(n),clip:r&&r.clip?_html2canvas.Util.Extend({},r.clip):null};return t.useOverflow===!0&&/(hidden|scroll|auto)/.test(i(n,"overflow"))===!0&&/(BODY)/i.test(n.nodeName)===!1&&(f.clip=f.clip?g(f.clip,u):u),f.zIndex.children.push(f),f}function vt(n,t,i){var r={left:t.left+n[3].width,top:t.top+n[0].width,width:t.width-(n[1].width+n[3].width),height:t.height-(n[0].width+n[2].width)};return i&&(r=g(r,i)),r}function ft(n,t,r){var e=_html2canvas.Util.Bounds(n),h,l=lt.test(n.nodeName)?"#efefef":i(n,"backgroundColor"),f=gt(n,t,e),o=f.borders,u=f.ctx,s=vt(o,e,f.clip),c=pi(n,e,o);k(u,c.clip),u.save(),u.clip(),s.height>0&&s.width>0&&(ti(u,e,l),wt(n,s,u)),u.restore(),c.borders.forEach(function(n){yi(u,n.args,n.color)}),r||pt(n,f);switch(n.nodeName){case"IMG":(h=d(n.getAttribute("src")))?nt(u,n,h,e,o):h2clog("html2canvas: Error loading <img>:"+n.getAttribute("src"));break;case"INPUT":/^(text|url|email|submit|button|reset)$/.test(n.type)&&(n.value||n.placeholder).length>0&&b(n,e,f);break;case"TEXTAREA":(n.value||n.placeholder||"").length>0&&b(n,e,f);break;case"SELECT":(n.options||n.placeholder||"").length>0&&b(n,e,f);break;case"LI":bi(n,f,s);break;case"CANVAS":nt(u,n,n,e,o)}return f}function ii(n){return i(n,"display")!=="none"&&i(n,"visibility")!=="hidden"&&!n.hasAttribute("data-html2canvas-ignore")}function a(n,t,i){ii(n)&&(t=ft(n,t,i)||t,lt.test(n.nodeName)||_html2canvas.Util.Children(n).forEach(function(r){r.nodeType===1?a(r,t,i):r.nodeType===3&&ct(n,r,t)}))}function ni(n,t){function u(n){for(var o=_html2canvas.Util.Children(n),h=o.length,e,r,s,t,f=0;f<h;f+=1){t=o[f];if(t.nodeType===3)i+=t.nodeValue.replace(/</g,"&lt;").replace(/>/g,"&gt;");else if(t.nodeType===1)if(!/^(script|meta|title)$/.test(t.nodeName.toLowerCase())){i+="<"+t.nodeName.toLowerCase();if(t.hasAttributes())for(e=t.attributes,s=e.length,r=0;r<s;r+=1)i+=" "+e[r].name+'="'+e[r].value+'"';i+=">",u(t),i+="</"+t.nodeName.toLowerCase()+">"}}}var r=new Image,f=rt(),e=ot(),i="";u(n),r.src=["data:image/svg+xml,","<svg xmlns='http://www.w3.org/2000/svg' version='1.1' width='"+f+"' height='"+e+"'>","<foreignObject width='"+f+"' height='"+e+"'>","<html xmlns='http://www.w3.org/1999/xhtml' style='margin:0;'>",i.replace(/\#/g,"%23"),"</html>","</foreignObject>","</svg>"].join(""),r.onload=function(){t.svgRender=r}}function at(){var n=ft(w,null);return st.svgRendering&&ni(document.documentElement,n),Array.prototype.slice.call(w.children,0).forEach(function(t){a(t,n)}),n.backgroundColor=i(document.documentElement,"backgroundColor"),v.removeChild(p),n}var u;window.scroll(0,0);var w=t.elements===undefined?document.body:t.elements[0],l=0,r=w.ownerDocument,st=_html2canvas.Util.Support(t,r),lt=new RegExp("("+t.ignoreElements+")"),v=r.body,i=_html2canvas.Util.getCSS,f="___html2canvas___pseudoelement",p=r.createElement("style");return p.innerHTML="."+f+'-before:before { content: "" !important; display: none !important; }.'+f+'-after:after { content: "" !important; display: none !important; }',v.appendChild(p),n=n||{},u=function(n){return function(t,i,r,u){var s=r*n,h=u*n,f=t+r,e=i+u;return{topLeft:o({x:t,y:e},{x:t,y:e-h},{x:f-s,y:i},{x:f,y:i}),topRight:o({x:t,y:i},{x:t+s,y:i},{x:f,y:e-h},{x:f,y:e}),bottomRight:o({x:f,y:i},{x:f,y:i+h},{x:t+s,y:e},{x:t,y:e}),bottomLeft:o({x:f,y:e},{x:f-s,y:e},{x:t,y:i+h},{x:t,y:i})}}}(4*((Math.sqrt(2)-1)/3)),at()},_html2canvas.Preload=function(n){function g(n){i.href=n,i.href=i.href;var t=i.protocol+i.host;return t===c}function r(){h2clog("html2canvas: start: images: "+t.numLoaded+" / "+t.numTotal+" (failed: "+t.numFailed+")"),t.firstRun||t.numLoaded<t.numTotal||(h2clog("Finished loading images: # "+t.numTotal+" (failed: "+t.numFailed+")"),typeof n.complete=="function"&&n.complete(t))}function v(u,e,o){var c,l=n.proxy,s;i.href=u,u=i.href,c="html2canvas_"+d++,o.callbackname=c,l+=l.indexOf("?")>-1?"&":"?",l+="url="+encodeURIComponent(u)+"&callback="+c,s=h.createElement("script"),window[c]=function(n){n.substring(0,6)==="error:"?(o.succeeded=!1,t.numLoaded++,t.numFailed++,r()):(f(e,o),e.src=n),window[c]=undefined;try{delete window[c]}catch(i){}s.parentNode.removeChild(s),s=null,delete o.script,delete o.callbackname},s.setAttribute("type","text/javascript"),s.setAttribute("src",l),o.script=s,window.document.body.appendChild(s)}function a(n,t){var r=window.getComputedStyle(n,t),i=r.content;i.substr(0,3)==="url"&&u.loadImage(_html2canvas.Util.parseBackgroundImage(i)[0].args[0]),s(r.backgroundImage,n)}function nt(n){a(n,":before"),a(n,":after")}function k(n,i){var u=_html2canvas.Generate.Gradient(n,i);u!==undefined&&(t[n]={img:u,succeeded:!0},t.numTotal++,t.numLoaded++,r())}function w(n){return n&&n.method&&n.args&&n.args.length>0}function s(n,t){var i;_html2canvas.Util.parseBackgroundImage(n).filter(w).forEach(function(n){n.method==="url"?u.loadImage(n.args[0]):n.method.match(/\-?gradient$/)&&(i===undefined&&(i=_html2canvas.Util.Bounds(t)),k(n.value,i))})}function l(n){var t=!1;try{_html2canvas.Util.Children(n).forEach(function(n){l(n)})}catch(r){}try{t=n.nodeType}catch(i){t=!1,h2clog("html2canvas: failed to access some element's nodeType - Exception: "+i.message)}if(t===1||t===undefined){nt(n);try{s(_html2canvas.Util.getCSS(n,"backgroundImage"),n)}catch(r){h2clog("html2canvas: failed to get background-image - Exception: "+r.message)}s(n)}}function f(i,u){i.onload=function(){u.timer!==undefined&&window.clearTimeout(u.timer),t.numLoaded++,u.succeeded=!0,i.onerror=i.onload=null,r()},i.onerror=function(){if(i.crossOrigin==="anonymous"){window.clearTimeout(u.timer);if(n.proxy){var f=i.src;i=new Image,u.img=i,i.src=f,v(i.src,i,u);return}}t.numLoaded++,t.numFailed++,u.succeeded=!1,i.onerror=i.onload=null,r()}}var t={numLoaded:0,numFailed:0,numTotal:0,cleanupDone:!1},c,u,e,d=0,p=n.elements[0]||document.body,h=p.ownerDocument,y=h.images,tt=y.length,i=h.createElement("a"),b=function(n){return n.crossOrigin!==undefined}(new Image),o;for(i.href=window.location.href,c=i.protocol+i.host,u={loadImage:function(i){var r,u;i&&t[i]===undefined&&(r=new Image,i.match(/data:image\/.*;base64,/i)?(r.src=i.replace(/url\(['"]{0,}|['"]{0,}\)$/ig,""),u=t[i]={img:r},t.numTotal++,f(r,u)):g(i)||n.allowTaint===!0?(u=t[i]={img:r},t.numTotal++,f(r,u),r.src=i):b&&!n.allowTaint&&n.useCORS?(r.crossOrigin="anonymous",u=t[i]={img:r},t.numTotal++,f(r,u),r.src=i,r.customComplete=function(){this.img.complete?this.img.onerror():this.timer=window.setTimeout(this.img.customComplete,100)}.bind(u),r.customComplete()):n.proxy&&(u=t[i]={img:r},t.numTotal++,v(i,r,u)))},cleanupDOM:function(i){var u,f;if(!t.cleanupDone){i&&typeof i=="string"?h2clog("html2canvas: Cleanup because: "+i):h2clog("html2canvas: Cleanup after timeout: "+n.timeout+" ms.");for(f in t)if(t.hasOwnProperty(f)){u=t[f];if(typeof u=="object"&&u.callbackname&&u.succeeded===undefined){window[u.callbackname]=undefined;try{delete window[u.callbackname]}catch(e){}u.script&&u.script.parentNode&&(u.script.setAttribute("src","about:blank"),u.script.parentNode.removeChild(u.script)),t.numLoaded++,t.numFailed++,h2clog("html2canvas: Cleaned up failed img: '"+f+"' Steps: "+t.numLoaded+" / "+t.numTotal)}}window.stop!==undefined?window.stop():document.execCommand!==undefined&&document.execCommand("Stop",!1),document.close!==undefined&&document.close(),t.cleanupDone=!0,i&&typeof i=="string"||r()}},renderingDone:function(){o&&window.clearTimeout(o)}},n.timeout>0&&(o=window.setTimeout(u.cleanupDOM,n.timeout)),h2clog("html2canvas: Preload starts: finding background-images"),t.firstRun=!0,l(p),h2clog("html2canvas: Preload: Finding images"),e=0;e<tt;e+=1)u.loadImage(y[e].getAttribute("src"));return t.firstRun=!1,h2clog("html2canvas: Preload: Done."),t.numTotal===t.numLoaded&&r(),u},_html2canvas.Renderer=function(n,t){function r(n){var i=[],t=function(n){var u=[],r=[];n.children.forEach(function(n){n.children&&n.children.length>0?(u.push(n),r.push(n.zindex)):i.push(n)}),r.sort(function(n,t){return n-t}),r.forEach(function(n){var i;u.some(function(t,r){return i=r,t.zindex===n}),t(u.splice(i,1)[0])})};return t(n.zIndex),i}function i(n){var i;if(typeof t.renderer=="string"&&_html2canvas.Renderer[n]!==undefined)i=_html2canvas.Renderer[n](t);else if(typeof n=="function")i=n(t);else throw new Error("Unknown renderer");if(typeof i!="function")throw new Error("Invalid renderer defined");return i}return i(t.renderer)(n,t,document,r(n),_html2canvas)},_html2canvas.Util.Support=function(n,t){function r(){var r=new Image,n=t.createElement("canvas"),i=n.getContext===undefined?!1:n.getContext("2d");if(i===!1)return!1;n.width=n.height=10,r.src=["data:image/svg+xml,","<svg xmlns='http://www.w3.org/2000/svg' width='10' height='10'>","<foreignObject width='10' height='10'>","<div xmlns='http://www.w3.org/1999/xhtml' style='width:10;height:10;'>","sup","</div>","</foreignObject>","</svg>"].join("");try{i.drawImage(r,0,0),n.toDataURL()}catch(u){return!1}return h2clog("html2canvas: Parse: SVG powered rendering available"),!0}function i(){var i,n,f,u,r=!1;return t.createRange&&(i=t.createRange(),i.getBoundingClientRect&&(n=t.createElement("boundtest"),n.style.height="123px",n.style.display="block",t.body.appendChild(n),i.selectNode(n),f=i.getBoundingClientRect(),u=f.height,u===123&&(r=!0),t.body.removeChild(n))),r}return{rangeBounds:i(),svgRendering:n.svgRendering&&r()}},window.html2canvas=function(n,t){n=n.length?n:[n];var r,u,i={logging:!1,elements:n,background:"#fff",proxy:null,timeout:0,useCORS:!1,allowTaint:!1,svgRendering:!1,ignoreElements:"IFRAME|OBJECT|PARAM",useOverflow:!0,letterRendering:!1,chinese:!1,width:null,height:null,taintTest:!0,renderer:"Canvas"};return i=_html2canvas.Util.Extend(t,i),_html2canvas.logging=i.logging,i.complete=function(n){if(typeof i.onpreloaded=="function")if(i.onpreloaded(n)===!1)return;r=_html2canvas.Parse(n,i);if(typeof i.onparsed=="function")if(i.onparsed(r)===!1)return;u=_html2canvas.Renderer(r,i);if(typeof i.onrendered=="function")i.onrendered(u)},window.setTimeout(function(){_html2canvas.Preload(i)},0),{render:function(n,t){return _html2canvas.Renderer(n,_html2canvas.Util.Extend(t,i))},parse:function(n,t){return _html2canvas.Parse(n,_html2canvas.Util.Extend(t,i))},preload:function(n){return _html2canvas.Preload(_html2canvas.Util.Extend(n,i))},log:h2clog}},window.html2canvas.log=h2clog,window.html2canvas.Renderer={Canvas:undefined},_html2canvas.Renderer.Canvas=function(n){function s(n,t){n.beginPath(),t.forEach(function(t){n[t.name].apply(n,t.arguments)}),n.closePath()}function h(n){if(f.indexOf(n.arguments[0].src)===-1){i.drawImage(n.arguments[0],0,0);try{i.getImageData(0,0,1,1)}catch(t){return r=u.createElement("canvas"),i=r.getContext("2d"),!1}f.push(n.arguments[0].src)}return!0}function e(n){return n==="transparent"||n==="rgba(0, 0, 0, 0)"}function o(t,i){switch(i.type){case"variable":t[i.name]=i.arguments;break;case"function":if(i.name==="createPattern"){if(i.arguments[0].width>0&&i.arguments[0].height>0)try{t.fillStyle=t.createPattern(i.arguments[0],"repeat")}catch(r){h2clog("html2canvas: Renderer: Error creating pattern",r.message)}}else i.name==="drawShape"?s(t,i.arguments):i.name==="drawImage"?i.arguments[8]>0&&i.arguments[7]>0&&(!n.taintTest||n.taintTest&&h(i))&&t.drawImage.apply(t,i.arguments):t[i.name].apply(t,i.arguments)}}n=n||{};var u=document,f=[],r=document.createElement("canvas"),i=r.getContext("2d"),t=n.canvas||u.createElement("canvas");return function(n,i,r,u,f){var s=t.getContext("2d"),h,v,a,l,c,y;t.width=t.style.width=i.width||n.ctx.width,t.height=t.style.height=i.height||n.ctx.height,y=s.fillStyle,s.fillStyle=e(n.backgroundColor)&&i.background!==undefined?i.background:n.backgroundColor,s.fillRect(0,0,t.width,t.height),s.fillStyle=y;if(i.svgRendering&&n.svgRender!==undefined)s.drawImage(n.svgRender,0,0);else for(v=0,a=u.length;v<a;v+=1)h=u.splice(0,1)[0],h.canvasPosition=h.canvasPosition||{},s.textBaseline="bottom",h.clip&&(s.save(),s.beginPath(),s.rect(h.clip.left,h.clip.top,h.clip.width,h.clip.height),s.clip()),h.ctx.storage&&h.ctx.storage.forEach(o.bind(null,s)),h.clip&&s.restore();h2clog("html2canvas: Renderer: Canvas renderer done - returning canvas obj"),a=i.elements.length;if(a===1)if(typeof i.elements[0]=="object"&&i.elements[0].nodeName!=="BODY")return c=f.Util.Bounds(i.elements[0]),l=r.createElement("canvas"),l.width=c.width,l.height=c.height,s=l.getContext("2d"),s.drawImage(t,c.left,c.top,c.width,c.height,0,0,c.width,c.height),t=null,l;return t}},(function(){for(var i=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"RequestCancelAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var u=+new Date,r=Math.max(0,16-(u-i)),f=window.setTimeout(function(){n(u+r)},r);return i=u+r,f}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})})()
